
library(dplyr)
library(readr)
library(igraph)  #  pour créer le graphe 


df <- read_delim("qualite-de-lair-dans-le-reseau-de-transport-francilien.csv", delim = ";", locale = locale(encoding = "UTF-8"))   # Remplacer le chemin si le fichier est ailleurs

metro_df <- df %>%
  filter(grepl("Métro", `Nom de la ligne`)) %>%           # garder que les lignes de métro
  select(`Nom de la Station`, `Nom de la ligne`) %>%      # garder colonnes utiles
  distinct()                                               # supprimer les doublons


graph_df <- metro_df %>%
  group_by(`Nom de la ligne`) %>%
  arrange(`Nom de la Station`) %>%
  mutate(station1 = lag(`Nom de la Station`),
         station2 = `Nom de la Station`) %>%
  filter(!is.na(station1)) %>%
  select(station1, station2) %>%
  mutate(connecte = TRUE)


write_csv(graph_df, "graphe_metro.csv")

# maintenant on va créer un objet graphe avec igraph pour visualiser 
edges_df <- graph_df %>% select(station1, station2)
metro_graph <- graph_from_data_frame(edges_df, directed = TRUE)


plot(metro_graph, vertex.size = 5, vertex.label.cex = 0.7, edge.arrow.size = 0.3) #  Visualiser le graphe

